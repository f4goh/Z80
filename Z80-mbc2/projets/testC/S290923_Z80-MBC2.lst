                                      1 ;--------------------------------------------------------
                                      2 ; File Created by SDCC : free open source ISO C Compiler
                                      3 ; Version 4.5.0 #15242 (MINGW64)
                                      4 ;--------------------------------------------------------
                                      5 	.module S290923_Z80_MBC2
                                      6 	
                                      7 	.optsdcc -mz80 sdcccall(1)
                                      8 ;--------------------------------------------------------
                                      9 ; Public variables in this module
                                     10 ;--------------------------------------------------------
                                     11 	.globl _IM1_IRQ_ISR
                                     12 	.globl _putchar
                                     13 	.globl _getchar
                                     14 ;--------------------------------------------------------
                                     15 ; special function registers
                                     16 ;--------------------------------------------------------
                         00000000    17 _Exec_port	=	0x0000
                         00000001    18 _StorOpc_port	=	0x0001
                         00000001    19 _SerRx_port	=	0x0001
                                     20 ;--------------------------------------------------------
                                     21 ; ram data
                                     22 ;--------------------------------------------------------
                                     23 	.area _DATA
    00000000                         24 _getchar_sysflags_10000_21:
    00000000                         25 	.ds 1
                                     26 ;--------------------------------------------------------
                                     27 ; ram data
                                     28 ;--------------------------------------------------------
                                     29 	.area _INITIALIZED
                                     30 ;--------------------------------------------------------
                                     31 ; absolute external ram data
                                     32 ;--------------------------------------------------------
                                     33 	.area _DABS (ABS)
                                     34 ;--------------------------------------------------------
                                     35 ; global & static initialisations
                                     36 ;--------------------------------------------------------
                                     37 	.area _HOME
                                     38 	.area _GSINIT
                                     39 	.area _GSFINAL
                                     40 	.area _GSINIT
                                     41 ;--------------------------------------------------------
                                     42 ; Home
                                     43 ;--------------------------------------------------------
                                     44 	.area _HOME
                                     45 	.area _HOME
                                     46 ;--------------------------------------------------------
                                     47 ; code
                                     48 ;--------------------------------------------------------
                                     49 	.area _CODE
                                     50 ;S290923_Z80-MBC2.c:236: // Nothing to do as IRQ are disabled.
                                     51 ;	---------------------------------
                                     52 ; Function IM1_IRQ_ISR
                                     53 ; ---------------------------------
    00000000                         54 _IM1_IRQ_ISR::
                                     55 ;S290923_Z80-MBC2.c:241: 
    00000000 C9               [10]   56 	ret
                                     57 ;S290923_Z80-MBC2.c:243: {
                                     58 ;	---------------------------------
                                     59 ; Function putchar
                                     60 ; ---------------------------------
    00000001                         61 _putchar::
    00000001 EB               [ 4]   62 	ex	de, hl
                                     63 ;S290923_Z80-MBC2.c:245: // Is a LF
    00000002 7B               [ 4]   64 	ld	a, e
    00000003 D6 0A            [ 7]   65 	sub	a, #0x0a
    00000005 B2               [ 4]   66 	or	a, d
    00000006 20 08            [12]   67 	jr	NZ, 00102$
                                     68 ;S290923_Z80-MBC2.c:248: Exec_port = 0x0d;           // Print a CR before;
    00000008 3E 01            [ 7]   69 	ld	a, #0x01
    0000000A D3 01            [11]   70 	out	(_StorOpc_port), a
                                     71 ;S290923_Z80-MBC2.c:249: }
    0000000C 3E 0D            [ 7]   72 	ld	a, #0x0d
    0000000E D3 00            [11]   73 	out	(_Exec_port), a
    00000010                         74 00102$:
                                     75 ;S290923_Z80-MBC2.c:251: Exec_port = (char) (c);
    00000010 3E 01            [ 7]   76 	ld	a, #0x01
    00000012 D3 01            [11]   77 	out	(_StorOpc_port), a
                                     78 ;S290923_Z80-MBC2.c:252: return c;
    00000014 7B               [ 4]   79 	ld	a, e
    00000015 D3 00            [11]   80 	out	(_Exec_port), a
                                     81 ;S290923_Z80-MBC2.c:253: }
                                     82 ;S290923_Z80-MBC2.c:254: 
    00000017 C9               [10]   83 	ret
                                     84 ;S290923_Z80-MBC2.c:256: {
                                     85 ;	---------------------------------
                                     86 ; Function getchar
                                     87 ; ---------------------------------
    00000018                         88 _getchar::
                                     89 ;S290923_Z80-MBC2.c:259: {
    00000018                         90 00101$:
                                     91 ;S290923_Z80-MBC2.c:261: sysflags = Exec_port;       // Read IOS SYSFLAGS;
    00000018 3E 83            [ 7]   92 	ld	a, #0x83
    0000001A D3 01            [11]   93 	out	(_StorOpc_port), a
                                     94 ;S290923_Z80-MBC2.c:262: }
    0000001C DB 00            [11]   95 	in	a, (_Exec_port)
    0000001E 32r00r00         [13]   96 	ld	(_getchar_sysflags_10000_21+0), a
                                     97 ;S290923_Z80-MBC2.c:264: return SerRx_port;
    00000021 3Ar00r00         [13]   98 	ld	a, (_getchar_sysflags_10000_21)
    00000024 CB 57            [ 8]   99 	bit	2, a
    00000026 28 F0            [12]  100 	jr	Z, 00101$
                                    101 ;S290923_Z80-MBC2.c:265: }
    00000028 DB 01            [11]  102 	in	a, (_SerRx_port)
    0000002A 5F               [ 4]  103 	ld	e, a
    0000002B 16 00            [ 7]  104 	ld	d, #0x00
                                    105 ;S290923_Z80-MBC2.c:266: 
    0000002D C9               [10]  106 	ret
                                    107 	.area _CODE
                                    108 	.area _INITIALIZER
                                    109 	.area _CABS (ABS)
